<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>..\js\assets\framework\javeline\javeline_xpath.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/capdfHydrogeochemCtrl.html">capdfHydrogeochemCtrl</a></li>
                                <li><a href="../classes/CapdfWMSService.html">CapdfWMSService</a></li>
                                <li><a href="../classes/collapseInfoPanelCtrl.html">collapseInfoPanelCtrl</a></li>
                                <li><a href="../classes/D3PlotService.html">D3PlotService</a></li>
                                <li><a href="../classes/defaultAnalyticCtrl.html">defaultAnalyticCtrl</a></li>
                                <li><a href="../classes/FilterStateService.html">FilterStateService</a></li>
                                <li><a href="../classes/GetCSWRecordService.html">GetCSWRecordService</a></li>
                                <li><a href="../classes/GetFilterParamService.html">GetFilterParamService</a></li>
                                <li><a href="../classes/GetWFSRelatedService.html">GetWFSRelatedService</a></li>
                                <li><a href="../classes/GetWMSRelatedService.html">GetWMSRelatedService</a></li>
                                <li><a href="../classes/GMLParserService.html">GMLParserService</a></li>
                                <li><a href="../classes/googleMapCtrl.html">googleMapCtrl</a></li>
                                <li><a href="../classes/GoogleMapService.html">GoogleMapService</a></li>
                                <li><a href="../classes/infoPanelCtrl.html">infoPanelCtrl</a></li>
                                <li><a href="../classes/LayerManagerService.html">LayerManagerService</a></li>
                                <li><a href="../classes/layerPanelCtrl.html">layerPanelCtrl</a></li>
                                <li><a href="../classes/layerSearchCtrl.html">layerSearchCtrl</a></li>
                                <li><a href="../classes/loadAnalyticCtrl.html">loadAnalyticCtrl</a></li>
                                <li><a href="../classes/loadFilterCtrl.html">loadFilterCtrl</a></li>
                                <li><a href="../classes/NVCLService.html">NVCLService</a></li>
                                <li><a href="../classes/pressureDbCtrl.html">pressureDbCtrl</a></li>
                                <li><a href="../classes/PreviewMapService.html">PreviewMapService</a></li>
                                <li><a href="../classes/QuerierPanelService.html">QuerierPanelService</a></li>
                                <li><a href="../classes/RenderHandlerService.html">RenderHandlerService</a></li>
                                <li><a href="../classes/RenderStatusService.html">RenderStatusService</a></li>
                                <li><a href="../classes/SimpleXPathService.html">SimpleXPathService</a></li>
                                <li><a href="../classes/StyleService.html">StyleService</a></li>
                                <li><a href="../classes/WFSService.html">WFSService</a></li>
                                <li><a href="../classes/WMS_1_1_0_Service.html">WMS_1_1_0_Service</a></li>
                                <li><a href="../classes/WMS_1_3_0_Service.html">WMS_1_3_0_Service</a></li>
                                <li><a href="../classes/WMSService.html">WMSService</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/analytic.html">analytic</a></li>
                                <li><a href="../modules/controllers.html">controllers</a></li>
                                <li><a href="../modules/http.html">http</a></li>
                                <li><a href="../modules/layer.html">layer</a></li>
                                <li><a href="../modules/map.html">map</a></li>
                                <li><a href="../modules/utility.html">utility</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: ..\js\assets\framework\javeline\javeline_xpath.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/********* IE XPath Object ************************************************
    Workaround for the lack of having an XPath parser on safari
    It works on Safari&#x27;s document and XMLDocument object.

    It doesn&#x27;t support the full XPath spec, but just enought for
    the skinning engine which needs XPath on the HTML document.

    Supports:
    - Compilation of xpath statements
    - Caching of XPath statements
****************************************************************************/
//Set up the $ method
IS_SAFARI = navigator.userAgent.toLowerCase().indexOf(&quot;safari&quot;) != -1 || navigator.userAgent.toLowerCase().indexOf(&quot;konqueror&quot;) != -1;
IS_SAFARI_OLD = IS_SAFARI &amp;&amp; parseInt((navigator.userAgent.match(/AppleWebKit\/(\d+)/)||{})[1]) &lt; 420;
IS_GECKO = document.implementation &amp;&amp; document.implementation.createDocument &amp;&amp; true;
IS_OPERA = navigator.userAgent.toLowerCase().indexOf(&quot;opera&quot;) != -1;
IS_IE = (!!navigator.userAgent.match(/Trident.*rv[ :]*11\./) || (document.all &amp;&amp; !IS_OPERA));

//This breaks for(x in o) loops in the old Safari
if(IS_SAFARI_OLD){
    HTMLHtmlElement = document.createElement(&quot;html&quot;).constructor;
    Node = HTMLElement = {};
    HTMLElement.prototype = HTMLHtmlElement.__proto__.__proto__;
    HTMLDocument = Document = document.constructor;
    var x = new DOMParser();
    XMLDocument = x.constructor;
    Element = x.parseFromString(&quot;&lt;Single /&gt;&quot;, &quot;text/xml&quot;).documentElement.constructor;
    x = null;
}

TAGNAME = IS_IE ? &quot;baseName&quot; : &quot;localName&quot;;
var _$ = function(tag, doc, prefix, force){
    return (doc || document).getElementsByTagName((prefix &amp;&amp; (force || IS_GECKO) ? prefix + &quot;:&quot; : &quot;&quot;) + tag);
}

XPath = {
    cache : {},

    getChildNode : function(htmlNode, tagName, info, count, num, sResult){
        var numfound = 0, result = null, data = info[count];

        var nodes = htmlNode.childNodes;
        if(!nodes) return; //Weird bug in Safari
        for(var i=0;i&lt;nodes.length;i++){
            if(tagName &amp;&amp; (nodes[i].style ? nodes[i].tagName.toLowerCase() : nodes[i].tagName) != tagName) continue;// || numsearch &amp;&amp; ++numfound != numsearch

            if(data) data[0](nodes[i], data[1], info, count+1, numfound++ , sResult);
            else sResult.push(nodes[i]);
        }

        //commented out :  &amp;&amp; (!numsearch || numsearch == numfound)
    },

    doQuery : function(htmlNode, qData, info, count, num, sResult){
        var result = null, data = info[count];
        var query = qData[0];
        var returnResult = qData[1];
        try{var qResult = eval(query);}catch(e){return;}

        if(returnResult) return sResult.push(qResult);
        if(!qResult) return;

        if(data) data[0](htmlNode, data[1], info, count+1, 0, sResult);
        else sResult.push(htmlNode);
    },

    getTextNode : function(htmlNode, empty, info, count, num, sResult){
        var result = null, data = info[count];

        var nodes = htmlNode.childNodes;
        for(var i=0;i&lt;nodes.length;i++){
            if(nodes[i].nodeType != 3 &amp;&amp; nodes[i].nodeType != 4) continue;

            if(data) data[0](nodes[i], data[1], info, count+1, i, sResult);
            else sResult.push(nodes[i]);
        }
    },

    getAnyNode : function(htmlNode, empty, info, count, num, sResult){
        var result = null, data = info[count];

        var sel = [], nodes = htmlNode.childNodes;
        for(var i=0;i&lt;nodes.length;i++){
            if(data) data[0](nodes[i], data[1], info, count+1, i, sResult);
            else sResult.push(nodes[i]);
        }
    },

    getAttributeNode : function(htmlNode, attrName, info, count, num, sResult){
        if(!htmlNode || htmlNode.nodeType != 1) return;

        var result = null, data = info[count];
        var value = htmlNode.getAttributeNode(attrName);//htmlNode.attributes[attrName];//

        if(data) data[0](value, data[1], info, count+1, 0, sResult);
        else if(value) sResult.push(value);
    },

    getAllNodes : function(htmlNode, x, info, count, num, sResult){
        var result = null, data = info[count];
        var tagName = x[0];
        var inclSelf = x[1];
        var prefix = x[2];

        if(inclSelf &amp;&amp; (htmlNode.tagName == tagName || tagName == &quot;*&quot;)){
            if(data) data[0](htmlNode, data[1], info, count+1, 0, sResult);
            else sResult.push(htmlNode);
        }

        var nodes = _$(tagName, htmlNode, tagName==prefix?&quot;&quot;:prefix);//htmlNode.getElementsByTagName(tagName);
        for(var i=0;i&lt;nodes.length;i++){
            if(data) data[0](nodes[i], data[1], info, count+1, i, sResult);
            else sResult.push(nodes[i]);
        }
    },

    getAllAncestorNodes : function(htmlNode, x, info, count, num, sResult){
        var result = null, data = info[count];
        var tagName = x[0];
        var inclSelf = x[1];
        var prefix = x[2];

        var i = 0, s = inclSelf ? htmlNode : htmlNode.parentNode;
        while(s &amp;&amp; s.nodeType == 1){
            if(s.tagName == tagName || tagName == &quot;*&quot; || tagName == &quot;node()&quot;){
                if(data) data[0](s, data[1], info, count+1, i++, sResult);
                else sResult.push(s);
            }
            s = s.parentNode
        }
    },

    getParentNode : function(htmlNode, empty, info, count, num, sResult){
        var result = null, data = info[count];
        var node = htmlNode.parentNode;

        if(data) data[0](node, data[1], info, count+1, 0, sResult);
        else if(node) sResult.push(node);
    },

    //precsiblg[3] might not be conform spec
    getPrecedingSibling : function(htmlNode, tagName, info, count, num, sResult){
        var result = null, data = info[count];

        var node = htmlNode.previousSibling;
        while(node){
            if(tagName != &quot;node()&quot; &amp;&amp; (node.style ? node.tagName.toLowerCase() : node.tagName) != tagName){
                node = node.previousSibling;
                continue;
            }

            if(data) data[0](node, data[1], info, count+1, 0, sResult);
            else if(node){
                sResult.push(node);
                break;
            }
        }
    },

    //flwsiblg[3] might not be conform spec
    getFollowingSibling : function(htmlNode, tagName, info, count, num, sResult){
        var result = null, data = info[count];

        var node = htmlNode.nextSibling;
        while(node){
            if(tagName != &quot;node()&quot; &amp;&amp; (node.style ? node.tagName.toLowerCase() : node.tagName) != tagName){
                node = node.nextSibling;
                continue;
            }

            if(data) data[0](node, data[1], info, count+1, 0, sResult);
            else if(node){
                sResult.push(node);
                break;
            }
        }
    },

    multiXpaths : function(contextNode, list, info, count, num, sResult){
        for(var i=0;i&lt;list.length;i++){
            var info = list[i][0];
            var rootNode = (info[3] ? contextNode.ownerDocument.documentElement : contextNode);//document.body
            info[0](rootNode, info[1], list[i], 1, 0, sResult);
        }

        sResult.makeUnique();
    },

    compile : function(sExpr){
        sExpr = sExpr.replace(/\[(\d+)\]/g, &quot;/##$1&quot;);
        sExpr = sExpr.replace(/\|\|(\d+)\|\|\d+/g, &quot;##$1&quot;);
        sExpr = sExpr.replace(/\.\|\|\d+/g, &quot;.&quot;);
        sExpr = sExpr.replace(/\[([^\]]*)\]/g, function(match, m1){
            return &quot;/##&quot; + m1.replace(/\|/g, &quot;_@_&quot;);
        }); //wrong assumption think of |

        if(sExpr == &quot;/&quot; || sExpr == &quot;.&quot;) return sExpr;

        //Mark // elements
        //sExpr = sExpr.replace(/\/\//g, &quot;/[]/self::&quot;);
        sExpr = sExpr.replace(/\/\//g, &quot;descendant::&quot;);

        //Check if this is an absolute query
        return this.processXpath(sExpr);
    },

    processXpath : function(sExpr){
        var results = new Array();
        sExpr = sExpr.replace(/(&#x27;[^&#x27;]*)\|([^&#x27;]*&#x27;)/g, &quot;$1_@_$2&quot;);
        sExpr = sExpr.split(&quot;\|&quot;);
        for(var i=0;i&lt;sExpr.length;i++)
            sExpr[i] = sExpr[i].replace(/_\@\_/g, &quot;|&quot;);//replace(/(&#x27;[^&#x27;]*)\_\@\_([^&#x27;]*&#x27;)/g, &quot;$1|$2&quot;);

        if(sExpr.length == 1) sExpr = sExpr[0];
        else{
            for(var i=0;i&lt;sExpr.length;i++) sExpr[i] = this.processXpath(sExpr[i]);
            results.push([this.multiXpaths, sExpr]);
            return results;
        }

        var isAbsolute = sExpr.match(/^\/[^\/]/);
        var sections = sExpr.split(&quot;/&quot;);
        for(var i=0;i&lt;sections.length;i++){
            if(sections[i] == &quot;.&quot; || sections[i] == &quot;&quot;) continue;
            else if(sections[i].match(/^[\w-_\.]+(?:\:[\w-_\.]+){0,1}$/)) results.push([this.getChildNode, sections[i]]);//.toUpperCase()
            else if(sections[i].match(/^\#\#(\d+)$/)) results.push([this.doQuery, [&quot;num+1 == &quot; + parseInt(RegExp.$1)]]);
            else if(sections[i].match(/^\#\#(.*)$/)){

                //FIX THIS CODE
                var query = RegExp.$1;
                var m = [query.match(/\(/g), query.match(/\)/g)];
                if(m[0] || m[1]){
                    while(!m[0] &amp;&amp; m[1] || m[0] &amp;&amp; !m[1] || m[0].length != m[1].length){
                        if(!sections[++i]) break;
                        query += &quot;/&quot; + sections[i];
                        m = [query.match(/\(/g), query.match(/\)/g)];
                    }
                }

                results.push([this.doQuery, [this.compileQuery(query)]]);
            }
            else if(sections[i] == &quot;*&quot;) results.push([this.getChildNode, null]); //FIX - put in def function
            else if(sections[i].substr(0,2) == &quot;[]&quot;) results.push([this.getAllNodes, [&quot;*&quot;, false]]);//sections[i].substr(2) ||
            else if(sections[i].match(/descendant-or-self::node\(\)$/)) results.push([this.getAllNodes, [&quot;*&quot;, true]]);
            else if(sections[i].match(/descendant-or-self::([^\:]*)(?:\:(.*)){0,1}$/)) results.push([this.getAllNodes, [RegExp.$2 || RegExp.$1, true, RegExp.$1]]);
            else if(sections[i].match(/descendant::([^\:]*)(?:\:(.*)){0,1}$/)) results.push([this.getAllNodes, [RegExp.$2 || RegExp.$1, false, RegExp.$1]]);
            else if(sections[i].match(/ancestor-or-self::([^\:]*)(?:\:(.*)){0,1}$/)) results.push([this.getAllAncestorNodes, [RegExp.$2 || RegExp.$1, true, RegExp.$1]]);
            else if(sections[i].match(/ancestor::([^\:]*)(?:\:(.*)){0,1}$/)) results.push([this.getAllAncestorNodes, [RegExp.$2 || RegExp.$1, false, RegExp.$1]]);
            else if(sections[i].match(/^\@(.*)$/)) results.push([this.getAttributeNode, RegExp.$1]);
            else if(sections[i] == &quot;text()&quot;) results.push([this.getTextNode, null]);
            else if(sections[i] == &quot;node()&quot;) results.push([this.getAnyNode, null]);//FIX - put in def function
            else if(sections[i] == &quot;..&quot;) results.push([this.getParentNode, null]);
            else if(sections[i].match(/following-sibling::(.*)$/)) results.push([this.getFollowingSibling, RegExp.$1.toLowerCase()]);
            else if(sections[i].match(/preceding-sibling::(.*)$/)) results.push([this.getPrecedingSibling, RegExp.$1.toLowerCase()]);
            else if(sections[i].match(/self::(.*)$/)) results.push([this.doQuery, [&quot;XPath.doXpathFunc(&#x27;local-name&#x27;, htmlNode) == &#x27;&quot; + RegExp.$1 + &quot;&#x27;&quot;]]);
            else{
                var query = sections[i];

                //FIX THIS CODE
                //add some checking here
                var m = [query.match(/\(/g), query.match(/\)/g)];
                if(m[0] || m[1]){
                    while(!m[0] &amp;&amp; m[1] || m[0] &amp;&amp; !m[1] || m[0].length != m[1].length){
                        if(!sections[++i]) break;
                        query += &quot;/&quot; + sections[i];
                        m = [query.match(/\(/g), query.match(/\)/g)];
                    }
                }

                results.push([this.doQuery, [this.compileQuery(query), true]])

                //throw new Error(1503, &quot;---- Javeline Error ----\nMessage : Could not match XPath statement: &#x27;&quot; + sections[i] + &quot;&#x27; in &#x27;&quot; + sExpr + &quot;&#x27;&quot;);
            }
        }

        results[0][3] = isAbsolute;
        return results;
    },

    compileQuery : function(code){
        var c = new CodeCompilation(code);
        return c.compile();
    },

    doXpathFunc : function(type, arg1, arg2, arg3){
        switch(type){
            case &quot;not&quot;: return !arg1;
            case &quot;position()&quot;: return num == arg1;
            case &quot;format-number&quot;: return new String(Math.round(parseFloat(arg1)*100)/100).replace(/(\.\d?\d?)$/, function(m1){return m1.pad(3, &quot;0&quot;, PAD_RIGHT)});; //this should actually do something
            case &quot;floor&quot;: return Math.floor(arg1);
            case &quot;ceiling&quot;: return Math.ceil(arg1);
            case &quot;starts-with&quot;: return arg1 ? arg1.substr(0, arg2.length) == arg2 : false;
            case &quot;string-length&quot;: return arg1 ? arg1.length : 0;
            case &quot;count&quot;: return arg1 ? arg1.length : 0;
            case &quot;last&quot;: return arg1 ? arg1[arg1.length-1] : null;
            case &quot;local-name&quot;: return arg1 ? arg1.tagName : &quot;&quot;;//[TAGNAME]
            case &quot;substring&quot;: return arg1 &amp;&amp; arg2 ? arg1.substring(arg2, arg3 || 0) : &quot;&quot;;
            case &quot;contains&quot;: return arg1 &amp;&amp; arg2 ? arg1.indexOf(arg2) &gt; -1 : false;
            case &quot;concat&quot;:
                for(var str=&quot;&quot;,i=1;i&lt;arguments.length;i++){
                    if(typeof arguments[i] == &quot;object&quot;){
                        str += getNodeValue(arguments[i][0]);
                        continue;
                    }
                    str += arguments[i];
                }
            return str;
        }
    },

    selectNodeExtended : function(sExpr, contextNode, match){
        var sResult = this.selectNodes(sExpr, contextNode);

        if(sResult.length == 0) return null;
        if(!match) return sResult[0];

        for(var i=0;i&lt;sResult.length;i++){
            if(getNodeValue(sResult[i]) == match) return sResult[i];
        }

        return null;
    },

    selectNodes : function(sExpr, contextNode){
        if(!this.cache[sExpr]) this.cache[sExpr] = this.compile(sExpr);

        //setStatus(&quot;Processing custom XPath: &quot; + sExpr + &quot;:&quot; + contextNode.serialize().replace(/&lt;/g, &quot;&amp;lt;&quot;));

        if(typeof this.cache[sExpr] == &quot;string&quot;){
            if(this.cache[sExpr] == &quot;.&quot;) return [contextNode];
            if(this.cache[sExpr] == &quot;/&quot;) return [contextNode.nodeType == 9 ? contextNode : contextNode.ownerDocument.documentElement];
        }

        if(typeof this.cache[sExpr] == &quot;string&quot; &amp;&amp; this.cache[sExpr] == &quot;.&quot;) return [contextNode];

        var info = this.cache[sExpr][0];
        var rootNode = (info[3] &amp;&amp; !contextNode.nodeType == 9 ? contextNode.ownerDocument.documentElement : contextNode);//document.body
        var sResult = [];

        info[0](rootNode, info[1], this.cache[sExpr], 1, 0, sResult);

        return sResult;
    }
}

function getNodeValue(sResult){
    if(sResult.nodeType == 1) return sResult.firstChild ? sResult.firstChild.nodeValue : &quot;&quot;;
    if(sResult.nodeType &gt; 1 || sResult.nodeType &lt; 5) return sResult.nodeValue;
    return sResult;
}

function CodeCompilation(code){
    this.data = {
        F : [],
        S : [],
        I : [],
        X : []
    };

    this.compile = function(){
        code = code.replace(/ or /g, &quot; || &quot;);
        code = code.replace(/ and /g, &quot; &amp;&amp; &quot;);
        code = code.replace(/!=/g, &quot;{}&quot;);
        code = code.replace(/=/g, &quot;==&quot;);
        code = code.replace(/\{\}/g, &quot;!=&quot;);

        // Tokenize
        this.tokenize();

        // Insert
        this.insert();

        return code;
    }

    this.tokenize = function(){
        //Functions
        var data = this.data.F;
        code = code.replace(/(format-number|contains|substring|local-name|last|node|position|round|starts-with|string|string-length|sum|floor|ceiling|concat|count|not)\s*\(/g, function(d, match){return (data.push(match) - 1) + &quot;F_&quot;;});

        //Strings
        var data = this.data.S;
        code = code.replace(/&#x27;([^&#x27;]*)&#x27;/g, function(d, match){return (data.push(match) - 1) + &quot;S_&quot;;});
        code = code.replace(/&quot;([^&quot;]*)&quot;/g, function(d, match){return (data.push(match) - 1) + &quot;S_&quot;;});

        //Xpath
        var data = this.data.X;
        code = code.replace(/(^|\W|\_)([\@\.\/A-Za-z][\.\@\/\w]*(?:\(\)){0,1})/g, function(d, m1, m2){return m1 + (data.push(m2) - 1) + &quot;X_&quot;;});
        code = code.replace(/(\.[\.\@\/\w]*)/g, function(d, m1, m2){return (data.push(m1) - 1) + &quot;X_&quot;;});

        //Ints
        var data = this.data.I;
        code = code.replace(/(\d+)(\W)/g, function(d, m1, m2){return (data.push(m1) - 1) + &quot;I_&quot; + m2;});
    }

    this.insert = function(){
        var data = this.data;
        code = code.replace(/(\d+)X_\s*==\s*(\d+S_)/g, function(d, nr, str){
            return &quot;XPath.selectNodeExtended(&#x27;&quot; +  data.X[nr].replace(/&#x27;/g, &quot;\\&#x27;&quot;) + &quot;&#x27;, htmlNode, &quot; + str + &quot;)&quot;;
        });

        code = code.replace(/(\d+)([FISX])_/g, function(d, nr, type){
            var value = data[type][nr];

            if(type == &quot;F&quot;){
                return &quot;XPath.doXpathFunc(&#x27;&quot; + value + &quot;&#x27;, &quot;;
            }
            else if(type == &quot;S&quot;){
                return &quot;&#x27;&quot; + value + &quot;&#x27;&quot;;
            }
            else if(type == &quot;I&quot;){
                return value;
            }
            else if(type == &quot;X&quot;){
                return &quot;XPath.selectNodeExtended(&#x27;&quot; + value.replace(/&#x27;/g, &quot;\\&#x27;&quot;) + &quot;&#x27;, htmlNode)&quot;;
            }
        });
    }
}

if(IS_SAFARI){
    HTMLDocument.prototype.selectNodes =
    Element.prototype.selectNodes =
    XMLDocument.prototype.selectNodes = function(sExpr, contextNode){
        return XPath.selectNodes(sExpr, contextNode || this);
    }
    HTMLDocument.prototype.selectSingleNode =
    Element.prototype.selectSingleNode =
    XMLDocument.prototype.selectSingleNode = function(sExpr, contextNode){
        return XPath.selectNodes(sExpr, contextNode || this)[0]; // This could be optimized in the XPath object
    }
}
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
