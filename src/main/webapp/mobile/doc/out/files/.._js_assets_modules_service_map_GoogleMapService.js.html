<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>..\js\assets\modules\service\map\GoogleMapService.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/capdfHydrogeochemCtrl.html">capdfHydrogeochemCtrl</a></li>
                                <li><a href="../classes/CapdfWMSService.html">CapdfWMSService</a></li>
                                <li><a href="../classes/collapseInfoPanelCtrl.html">collapseInfoPanelCtrl</a></li>
                                <li><a href="../classes/D3PlotService.html">D3PlotService</a></li>
                                <li><a href="../classes/defaultAnalyticCtrl.html">defaultAnalyticCtrl</a></li>
                                <li><a href="../classes/FilterStateService.html">FilterStateService</a></li>
                                <li><a href="../classes/GetCSWRecordService.html">GetCSWRecordService</a></li>
                                <li><a href="../classes/GetFilterParamService.html">GetFilterParamService</a></li>
                                <li><a href="../classes/GetWFSRelatedService.html">GetWFSRelatedService</a></li>
                                <li><a href="../classes/GetWMSRelatedService.html">GetWMSRelatedService</a></li>
                                <li><a href="../classes/GMLParserService.html">GMLParserService</a></li>
                                <li><a href="../classes/googleMapCtrl.html">googleMapCtrl</a></li>
                                <li><a href="../classes/GoogleMapService.html">GoogleMapService</a></li>
                                <li><a href="../classes/infoPanelCtrl.html">infoPanelCtrl</a></li>
                                <li><a href="../classes/LayerManagerService.html">LayerManagerService</a></li>
                                <li><a href="../classes/layerPanelCtrl.html">layerPanelCtrl</a></li>
                                <li><a href="../classes/layerSearchCtrl.html">layerSearchCtrl</a></li>
                                <li><a href="../classes/loadAnalyticCtrl.html">loadAnalyticCtrl</a></li>
                                <li><a href="../classes/loadFilterCtrl.html">loadFilterCtrl</a></li>
                                <li><a href="../classes/NVCLService.html">NVCLService</a></li>
                                <li><a href="../classes/pressureDbCtrl.html">pressureDbCtrl</a></li>
                                <li><a href="../classes/PreviewMapService.html">PreviewMapService</a></li>
                                <li><a href="../classes/QuerierPanelService.html">QuerierPanelService</a></li>
                                <li><a href="../classes/RenderHandlerService.html">RenderHandlerService</a></li>
                                <li><a href="../classes/RenderStatusService.html">RenderStatusService</a></li>
                                <li><a href="../classes/SimpleXPathService.html">SimpleXPathService</a></li>
                                <li><a href="../classes/StyleService.html">StyleService</a></li>
                                <li><a href="../classes/WFSService.html">WFSService</a></li>
                                <li><a href="../classes/WMS_1_1_0_Service.html">WMS_1_1_0_Service</a></li>
                                <li><a href="../classes/WMS_1_3_0_Service.html">WMS_1_3_0_Service</a></li>
                                <li><a href="../classes/WMSService.html">WMSService</a></li>
                            </ul>
                
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/analytic.html">analytic</a></li>
                                <li><a href="../modules/controllers.html">controllers</a></li>
                                <li><a href="../modules/http.html">http</a></li>
                                <li><a href="../modules/layer.html">layer</a></li>
                                <li><a href="../modules/map.html">map</a></li>
                                <li><a href="../modules/utility.html">utility</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: ..\js\assets\modules\service\map\GoogleMapService.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * Service class related to handling all things related to google map.
 * @module map
 * @class GoogleMapService
 * @event draw.zoom.start - start of the drawing for the zoom event
 * @event draw.zoom.end - end of the drawing for the zoom event
 * @event data.select.start - start of the drawing for the data selection event
 * @event data.select.end - end of the drawing for the data selection event
 * @event layer.removed - removing of a layer from map event
 */
allModules.service(&#x27;GoogleMapService&#x27;,[&#x27;$rootScope&#x27;,&#x27;UtilitiesService&#x27;,&#x27;RenderStatusService&#x27;,&#x27;$timeout&#x27;,&#x27;$filter&#x27;,&#x27;Constants&#x27;,&#x27;FilterStateService&#x27;,
                                       function ($rootScope,UtilitiesService,RenderStatusService,$timeout,$filter,Constants,FilterStateService) {
   
    this.mainMap = null;
    this.init_cb = [];
    this.activeLayers = {};
    this.layerOrder = {};
    this.useLayerReordering = true;
    this.heatmap = null;
    this.drawingManager = null;
    this.dataSelectDrawingManager = null;
    this.onBusyStartFn = null;
    this.onBusyEndFn = null;
    this.isBusy = false;
    this.controlUI = null;
    
    var me = this;
    
    /**
     * Get an instance of the map
     * @method getMap
     * @return map - an instance of the map. Make sure this is called after map has been initialized
     */
    this.getMap = function() {
        return this.mainMap;
    };
    
    /**
     * Register a function to call once the Google Map has been initialised
     * If the map has already been initialised, then the function is called 
     * immediately
     * @method getMapWhenReady
     * @param cb_fn callback function to be called
     */
    this.getMapWhenReady = function(cb_fn) {
        if (!this.mainMap) {
            this.init_cb.push(cb_fn);
            return;
        }
        cb_fn(this.mainMap);
    };
    
    /**
     * Return the current bounds of the map
     * @Method getCurrentViewPort
     * @return Bounds - the bounds of the view port.
     */
    this.getCurrentViewPort = function(){
        return this.mainMap.getBounds();
    };
    
    /**
     * Holds a array reference to the active markers on the map referenced by the layerId
     * @method addMarkerToActive
     * @param layerId - layerId
     * @param marker - the marker to add 
     */
    this.addMarkerToActive = function(layerId, marker){
        //VT: if not initialized, init the object.
        if(!this.activeLayers[layerId]){
            this.activeLayers[layerId]={};
            this.activeLayers[layerId].markers = [];
        }
        this.activeLayers[layerId].markers.push(marker);
    };
    
    /**
     * Check if the layer is still active. This reuses RenderStatusService.isLayerActive. Alternatively you can check
     * this.activeLayers[layerId]
     * @method isLayerActive
     * @param layer - layer
     */
    this.isLayerActive = function(layer){
       return RenderStatusService.isLayerActive(layer);
    };
    
    /**
     * Overlay a heat map to the data set
     * @method addHeatMapOverlay
     */
    this.addHeatMapOverlay = function(){
        var heatmapData = [];        
        for(var i in this.activeLayers){
            for(var j in this.activeLayers[i].markers){
                heatmapData.push(new google.maps.LatLng(this.activeLayers[i].markers[j].position.lat(),this.activeLayers[i].markers[j].position.lng()));
            }
        }
        if(!UtilitiesService.isEmpty(heatmapData)){
            this.heatmap = new google.maps.visualization.HeatmapLayer({
                data: heatmapData
            });
            this.heatmap.set(&#x27;radius&#x27;, 20);
            this.heatmap.setMap(this.mainMap);
            return true;
        }
        return false;
    };
    
    /**
     * remove the heatmap overlay
     * @method removeHeatMapOverlay
     */
    this.removeHeatMapOverlay = function(){  
        
        this.heatmap.setMap(null);        
        this.heatmap=null;
    };
    
    
    
    /**
     * Holds a array reference to the active layers on the map referenced by the layerId
     * @method addLayerToActive
     * @param layer - layer
     * @param mapLayer - the map layer to add 
     */
    this.addLayerToActive = function(layer,mapLayer){
        var layerId = layer.id;
        if(!this.activeLayers[layerId]){
            this.activeLayers[layerId]={};
            this.activeLayers[layerId].layers = [];
        }
        this.activeLayers[layerId].layers.push(mapLayer);
        this.broadcast(&#x27;layer.added&#x27;,layer);
        
        // Update the overlay map data structures
        this.syncOverlayMapDS();
    };
   
    /**
     * Synchronises data structures used to keep track of Google &#x27;overlayMapType&#x27; layers
     * @method syncOverlayMapDS
     * @return true if could synchronise
     */
    this.syncOverlayMapDS = function() {

        // Loop over all layers
        for (var layerId in this.activeLayers) {
            
            // Select map layers only - not markers
            if (this.activeLayers[layerId].hasOwnProperty(&#x27;layers&#x27;)) {
                this.activeLayers[layerId].overlayMapIdx = [];
                for (var activeIdx=0; activeIdx&lt;this.activeLayers[layerId].layers.length; activeIdx++) {

                    // Update the overlay map index
                    var overlayMap = this.activeLayers[layerId].layers[activeIdx];
                    var overlayMapIdx=this.findOverlayMap(overlayMap);
                    if (overlayMapIdx&gt;=0) {
                        this.activeLayers[layerId].overlayMapIdx.push(overlayMapIdx);
                    } else {
                        console.error(&quot;Cannot find overlay map&quot;);
                        return false;
                    }
                }
            }
        }
        
        // Update the layer ordering
        this.layerOrder = {};
        var orderIdx = 0;
        var overlayArr = me.mainMap.overlayMapTypes.getArray();
        for (var i=0; i&lt;overlayArr.length; i++) {
            var layerId=this.findLayerId(overlayArr[i]);
            if (layerId!=&quot;&quot; &amp;&amp; !this.layerOrder.hasOwnProperty(layerId)) {
                this.layerOrder[layerId] = orderIdx;
                orderIdx += 1;
            }
        }
        return true;
    }
    
    
    /**
     * Searches for an &#x27;overlayMap&#x27; within the current main map
     * @method findOverlayMap
     * @param overlayMap Google &#x27;overlayMap&#x27; to search for
     * @return index to map, or -1 if not found
     */
    this.findOverlayMap = function(overlayMap) {
        var overlayArr = me.mainMap.overlayMapTypes.getArray();
        for (var i=0; i&lt;overlayArr.length; i++) {
            if (overlayArr[i]===overlayMap) {
                return i;
            }
        }
        return -1;
    };
    
    /**
     * Searches for a Google &#x27;overlayMap&#x27; within the active layers returning its layer id
     * @method findLayerId
     * @param activeMap Google &#x27;overlayMap&#x27; to search for
     * @returns layer id, string or &quot;&quot; if could not be found
     */
    this.findLayerId = function(activeMap) {
        for (var layerId in this.activeLayers) {
            if (this.activeLayers[layerId].hasOwnProperty(&#x27;layers&#x27;)) {
                for (var i=0; i&lt;this.activeLayers[layerId].layers.length; i++) {
                    if (this.activeLayers[layerId].layers[i] === activeMap) return layerId;
                }
            }
        }
        return &quot;&quot;;
    };
    
    /**
     * Return the list of active layers
     * @method getMapActiveLayer
     * @return activeLayers - the list of active layers
     */
    this.getMapActiveLayer = function(){
        return this.activeLayers;
    };
    
    /**
     * Given a layer and an opacity, set the opacity of the layer
     * @method setLayerOpacity
     * @param layer - the layer whose opacity will be set
     * @param opacity - opacity value 
     */ 
    this.setLayerOpacity = function(layer, opacity) {
        if (this.activeLayers[layer.id]) {
            if (this.activeLayers[layer.id].hasOwnProperty(&#x27;layers&#x27;)) {
                for (var i = 0; i &lt; this.activeLayers[layer.id].layers.length; i++) {
                    this.activeLayers[layer.id].layers[i].setOpacity(opacity);
                }
            }
        }
    };
    
   
   /**
    * Remove the layer if it is rendered on the map
    * @method removeActiveLayer
    * @param layer - the csw layer to remove from map 
    */ 
    this.removeActiveLayer = function(layer){
        if (this.activeLayers[layer.id]) {
            if (this.activeLayers[layer.id].hasOwnProperty(&#x27;markers&#x27;)) {
                for (var i = 0; i &lt; this.activeLayers[layer.id].markers.length; i++) {
                    this.activeLayers[layer.id].markers[i].setMap(null);                    
                };
                this.activeLayers[layer.id].markers=[];
            };
            
            if (this.activeLayers[layer.id].hasOwnProperty(&#x27;layers&#x27;)) {
                for (var i = 0; i &lt; this.activeLayers[layer.id].layers.length; i++) {
                    var layerIndex = this.mainMap.overlayMapTypes.indexOf(this.activeLayers[layer.id].layers[i]);
                    this.mainMap.overlayMapTypes.removeAt(layerIndex);
                };
                this.activeLayers[layer.id].layers=[];
            };
            
            // Remove indexes from overlayMap
            if (this.activeLayers[layer.id].hasOwnProperty(&#x27;overlayMapIdx&#x27;)) {
                this.activeLayers[layer.id].overlayMapIdx=[];
            };
           
            this.broadcast(&#x27;layer.removed&#x27;,layer);
        };

        RenderStatusService.clearStatus(layer);
        
        // Update the overlay map data structures
        this.syncOverlayMapDS();
        
        // Remove this filter from registry
        FilterStateService.deregisterFilterSettings(layer.id);
    };
     
    /**
     * Initialize the map
     * @method initMap
     * @param mapDivId HTML id attribute of the &lt;div&gt; element where the map will be placed 
     * 
     */
    this.initMap = function(mapDivId) {
        var mq = window.matchMedia(Constants.smallScreenTest);
        this.mainMap = new google.maps.Map(document.getElementById(mapDivId), {
            center: {lat: -28.397, lng: 132.644},
            minZoom:(mq.matches? 3 : 4),
            zoom: (mq.matches? 3 : 5),
            mapTypeControlOptions: {
                style: google.maps.MapTypeControlStyle.DROPDOWN_MENU ,
                // Move the control to the top right corner for small screens so it won&#x27;t obscure Victoria &amp; Tasmania
                position: (mq.matches? google.maps.ControlPosition.TOP_RIGHT : google.maps.ControlPosition.RIGHT_BOTTOM)
            },
        });
        
        // Call any functions that have been waiting for this to initialise
        if (this.init_cb.length&gt;0) {
            for (i=0; i&lt;this.init_cb.length; i++) {
                this.init_cb[i](this.mainMap);
            }
        }
        
        this.mainMap.addListener(&#x27;mousemove&#x27;, function(evt) {
            $(&quot;#mouse-move-display-lat&quot;).text(&quot;Lat: &quot; + $filter(&#x27;number&#x27;)(evt.latLng.lat(),2));
            $(&quot;#mouse-move-display-lng&quot;).text(&quot;Lng: &quot; + $filter(&#x27;number&#x27;)(evt.latLng.lng(),2));
        });
        
    };
    
    /**
     * Fetches the state of the map in the form of a JSON string
     * @method getMapState
     * @return JSON string of map state
     */
    this.getMapState = function() {
        var retVal = { t: this.mainMap.getCenter().lat(), g: this.mainMap.getCenter().lng(), z: this.mainMap.getZoom() };
        return retVal;  
    };
    
    /**
     * Sets the state of the map according to a JSON string
     * @method setMapState
     * @param state JSON object of map state
     */
    this.setMapState = function(state) {
        if (state.hasOwnProperty(&#x27;t&#x27;) &amp;&amp; state.hasOwnProperty(&#x27;g&#x27;)) {
            this.mainMap.setCenter({lat: state.t, lng: state.g});
        }
        if (state.hasOwnProperty(&#x27;z&#x27;)) {
            this.mainMap.setZoom(state.z);
        }
    };
      
    /**
     * Enable the drawing of rectangle and zooming to the area drawn
     * @method zoomDraw
     */
    this.zoomDraw = function(){
        this.broadcast(&#x27;draw.zoom.start&#x27;);
        if(!this.drawingManager){
            this.drawingManager = new google.maps.drawing.DrawingManager();
            this.drawingManager.setOptions({
                drawingMode : google.maps.drawing.OverlayType.RECTANGLE,
                drawingControl : true,
                drawingControlOptions : {
                    position : google.maps.ControlPosition.TOP_CENTER,
                    drawingModes : [ google.maps.drawing.OverlayType.RECTANGLE ]
                },
                rectangleOptions : {
                    strokeColor : &#x27;#6c6c6c&#x27;,
                    strokeWeight : 3.5,
                    fillColor : &#x27;#926239&#x27;,
                    fillOpacity : 0.6,
                    editable: false,
                    draggable: false
                }   
            });
        }          
         
        var me = this;
        var afterZoomHandler = google.maps.event.addListener(this.drawingManager, &#x27;rectanglecomplete&#x27;, function(rect) {
            me.mainMap.fitBounds(rect.bounds);
            me.broadcast(&#x27;draw.zoom.end&#x27;);
            google.maps.event.removeListener(afterZoomHandler);                
            $timeout(function() {
                rect.setMap(null);
            }, 1500);
            me.drawingManager.setMap(null);
        });
          
        // Loading the drawing Tool in the Map.
        this.drawingManager.setMap(this.mainMap);
    };
                 
      
    /**
     * event for cancellation of the drawing of rectangle and zooming to the area drawn
     * @method zoomDrawCancel
     */
    this.zoomDrawCancel = function(){
        this.broadcast(&#x27;draw.zoom.end&#x27;);
        if (this.drawingManager)        
            this.drawingManager.setMap(null);
    };
   
    
    
    /**
     * event to capture the start of the draw zoom event
     * @method onDrawZoomStart
     * @param $scope of the caller
     * @param callback - callback function
     */            
    this.onDrawZoomStart = function ($scope, callback) {
        $scope.$on(&#x27;draw.zoom.start&#x27;, function (evt) {
            callback(evt);
        });
    };
      
    /**
     * event to capture the end of the draw zoom event
     * @method onDrawZoomEnd
     * @param $scope of the caller
     * @param callback - callback function
     */  
    this.onDrawZoomEnd = function ($scope, callback) {
        $scope.$on(&#x27;draw.zoom.end&#x27;, function (evt) {
            callback(evt);
        });
    };
      
      
    /**
     * Enable the drawing of bounding box for selecting data
     * @method selectMapData
     */
    this.selectMapData = function(){
        this.broadcast(&#x27;data.select.start&#x27;);
        if(!this.dataSelectDrawingManager){
            this.dataSelectDrawingManager = new google.maps.drawing.DrawingManager();
            this.dataSelectDrawingManager.setOptions({
                drawingMode : google.maps.drawing.OverlayType.RECTANGLE,
                drawingControl : true,
                drawingControlOptions : {
                    position : google.maps.ControlPosition.RIGHT_BOTTOM,
                    drawingModes : [ google.maps.drawing.OverlayType.RECTANGLE ]
                },
                rectangleOptions : {
                    strokeColor : &#x27;#00cc00&#x27;,
                    strokeWeight : 3.5,
                    fillColor : &#x27;#b3ffb3&#x27;,
                    fillOpacity : 0.6,
                    editable: false,
                    draggable: false
                }   
            });
        }          
         
        var me = this;
        var afterSelectionHandler = google.maps.event.addListener(this.dataSelectDrawingManager, &#x27;rectanglecomplete&#x27;, function(rect) {              
            me.broadcast(&#x27;data.select.end&#x27;,rect.bounds);
            google.maps.event.removeListener(afterSelectionHandler);                
            $timeout(function() {
                rect.setMap(null);
            }, 200);
            me.dataSelectDrawingManager.setMap(null);
        });
          
        // Loading the drawing Tool in the Map.
        this.dataSelectDrawingManager.setMap(this.mainMap);
    };
      
    /**
     * cancel the drawing of rectangle and data selection
     * @method selectDataDrawCancel
     */
    this.selectDataDrawCancel = function(){
        this.broadcast(&#x27;data.select.end&#x27;);              
        this.drawingManager.setMap(null);
    };
   
    
    
    /**
     * event to capture the start of the data selection event
     * @method onSelectDataStart
     * @param $scope of the caller
     * @param callback - callback function
     */            
    this.onSelectDataStart = function ($scope, callback) {
        $scope.$on(&#x27;data.select.start&#x27;, function (evt) {
            callback(evt);
        });
    };
      
    /**
     * event to capture the end of the data selection event
     * @method onSelectDataEnd
     * @param $scope of the caller
     * @param callback - callback function
     */  
    this.onSelectDataEnd = function ($scope, callback) {
        $scope.$on(&#x27;data.select.end&#x27;, function (evt,bound) {
            callback(evt,bound);
        });
    };
      
      
    /**
     * event to capture the removal of a layer
     * @method onLayerRemoved
     * @param $scope of the caller
     * @param callback - callback function
     */  
    this.onLayerRemoved = function($scope,callback){
        return $scope.$on(&#x27;layer.removed&#x27;,function(evt,layer){
            callback(evt,layer);
        }); 
    };
      
    /**
     * event to capture the adding of a layer
     * @method onLayerAdded
     * @param $scope of the caller
     * @param callback - callback function
     */ 
    this.onLayerAdded = function($scope,callback){
        return $scope.$on(&#x27;layer.added&#x27;,function(evt,layer){
            callback(evt,layer);
        }); 
    };
      
    /**
     * Broadcasts an event to all listeners via $rootScope
     * @method broadcast
     * @param event name of event (string)
     * @param result arguments to be passed
     */
    this.broadcast = function (event,result) {
        $rootScope.$broadcast(event,result);
    };
     
    /**
     * Register a callback function belonging to the map controller that this service will call when told a busy period has started
     * @method onBusyStart
     * @param callback - callback function
     */
    this.onBusyStart = function(callback) {
        this.onBusyStartFn  = callback;
    };
      
    /**
     * Register a callback function belonging to the map controller that this service will call when told that the busy period is over
     * @method onBusyEnd
     * @param callback - callback function
     */
    this.onBusyEnd = function(callback) {
        this.onBusyEndFn = callback;
    };
      
    /**
     * Function to set the map to busy, i.e. show a loading image
     * @method busyStart
     */
    this.busyStart = function() {
        if (!this.isBusy &amp;&amp; this.onBusyStartFn) {
            this.onBusyStartFn();
            this.isBusy = true;
        }
    };
      
    /**
     * Function to stop the map being busy, i.e. stop showing a loading image
     * @method busyEnd
     */
    this.busyEnd = function() {
        if (this.isBusy &amp;&amp; this.onBusyEndFn) {
            this.onBusyEndFn();
            this.isBusy = false;
        }
    };

    
    /**
     * Moves layer to the front of the map layers
     * @method moveLayerToFront
     * @param layer layer object
     */
    this.moveLayerToFront = function(layer) {
        var layerId = layer.id;
        if (this.activeLayers.hasOwnProperty(layerId)) {
            for (var idx=0; idx&lt;this.activeLayers[layerId].overlayMapIdx.length; idx++) {
                var overlayMapIdx = this.activeLayers[layerId].overlayMapIdx[idx];
                if (overlayMapIdx&gt;=0) {
                    // Shuffle, then update datastructures
                    var overlay0=this.mainMap.overlayMapTypes.removeAt(overlayMapIdx);
                    this.mainMap.overlayMapTypes.push(overlay0);
                    this.syncOverlayMapDS();
                } else {
                    console.error(&quot;overlayMapIdx out of range&quot;);
                }
            }
        }
    };
    
    
    /**
     * Returns true if a layer is at the front of the map layers
     * @method isLayerAtFront
     * @param layer layer object
     * @return true if the layer is at the front, or not an active layer
     */
    this.isLayerAtFront = function(layer) {
        var targetlayerId = layer.id;
        if (this.layerOrder.hasOwnProperty(targetlayerId)) {
            var targetOrder = this.layerOrder[targetlayerId];
            for (layerId in this.layerOrder) {
                if (this.layerOrder[layerId] &gt; targetOrder) return false;
            }
        }
        return true;
    };
     
}]);
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
